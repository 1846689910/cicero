"use strict";exports.__esModule=true;exports.default=void 0;var defaultOptions={validate:function validate(results){return results.every(function(x){return!!x})},validCallback:function validCallback(){},invalidCallback:function invalidCallback(){},beforeApply:function beforeApply(){},afterApply:function afterApply(){},beforeUnapply:function beforeUnapply(){},afterUnapply:function afterUnapply(){}};var FormValidator=function FormValidator(evUnits,options){var _this=this;if(options===void 0){options={}}this.apply=function(){if(!_this._applied){_this.options.beforeApply();_this.evUnits.forEach(function(x,i){(function(evUnit,idx){var listener=function listener(){_this._validateSingleElement(evUnit,idx);_this._triggerCallback()};evUnit.element.addEventListener("input",listener,false);_this._listeners.set(evUnit.element,listener);_this._validateSingleElement(evUnit,idx)})(x,i)});_this._triggerCallback();_this._applied=true;_this.options.afterApply()}return _this};this.unapply=function(){if(_this._applied){_this.options.beforeUnapply();_this.evUnits.forEach(function(x){var listener=_this._listeners.get(x.element);x.element.removeEventListener("input",listener,false);_this._listeners.delete(x.element);_this._unsetSingleElementStyle(x)});_this._applied=false;_this._results=[];_this.options.afterUnapply()}return _this};this._setSingleElementStyle=function(evUnit,i){Object.entries(_this._results[i]?evUnit.options.validStyle:evUnit.options.invalidStyle).forEach(function(_ref){var k=_ref[0],v=_ref[1];return evUnit.element.style[k]=v})};this._validateSingleElement=function(evUnit,i){_this._results[i]=evUnit.validator(evUnit.element);_this._setSingleElementStyle(evUnit,i)};this._unsetSingleElementStyle=function(evUnit){Object.entries(evUnit.options._originalStyle).forEach(function(_ref2){var k=_ref2[0],v=_ref2[1];return evUnit.element.style[k]=v})};this.isValid=function(){return _this.options.validate(_this._results)};this._triggerCallback=function(){_this.isValid()?_this.options.validCallback():_this.options.invalidCallback()};this.evUnits=evUnits;this.options=Object.assign({},defaultOptions,options);this._applied=false;this._results=[];this._listeners=new WeakMap};exports.default=FormValidator;