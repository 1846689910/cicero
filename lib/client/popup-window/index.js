"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=true;exports.default=void 0;var _jquery=_interopRequireDefault(require("jquery"));require("jquery-ui-dist/jquery-ui.min.js");require("jquery-ui-dist/jquery-ui.min.css");var _fontAwesomeMin=_interopRequireDefault(require("font-awesome/css/font-awesome.min.css"));var _DomElement=_interopRequireDefault(require("../element/DomElement"));var _configs=require("./configs");var _utils=require("./utils");var PopupWindow=function PopupWindow(props){var _this=this;if(props===void 0){props={}}this.getWindow=function(){return _this._window};this.getWindowTitle=function(){return _this._windowTitle};this.getWindowBody=function(){return _this._windowBody};this.getMinBtn=function(){return _this._minBtn};this.getMaxBtn=function(){return _this._maxBtn};this.getCloseBtn=function(){return _this._closeBtn};this.isOpen=function(){return _this._opened};this._windowGen=function(){var eleWindow=new _DomElement.default("div").workOnClassList(function(x){return x.add("cicero-popup-window")}).setStyle(_this._windowStyle);var windowTitle=new _DomElement.default("div").workOnClassList(function(x){return x.add("cicero-popup-window-title")}).setStyle(_this._windowTitleStyle).innerHTML('<span style="display: inline-block; width: 40%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">'+_this.title+"</span>").get();var windowBody=new _DomElement.default("div").workOnClassList(function(x){return x.add("cicero-popup-window-body")}).setStyle(_this._windowBodyStyle).innerHTML(_this.bodyHtml).get();eleWindow.append(windowTitle,windowBody,_this._btnGroup);return[eleWindow.get(),windowTitle,windowBody]};this._btnGen=function(btnType){var style;if(btnType==="CLOSE"){style=_configs.closeBtnStyle}else if(btnType==="MIN"){style=_configs.minBtnStyle}else{style=_configs.maxBtnStyle}return new _DomElement.default("i").workOnClassList(function(x){x.add(_fontAwesomeMin.default.fa);x.add(_fontAwesomeMin.default["fa-circle"]);x.add("cicero-popup-window-btn-"+btnType.toLowerCase())}).set("aria-hidden","true").setStyle(style).get()};this._btnGroupGen=function(){var _setStyle;return(_setStyle=new _DomElement.default("div").setStyle(_configs.btnGroupStyle)).append.apply(_setStyle,arguments).get()};this._bindEvents=function(){if(_this.isOpen()&&_this._window){var _this$events=_this.events,beforeClose=_this$events.beforeClose,afterClose=_this$events.afterClose,beforeMinimize=_this$events.beforeMinimize,afterMinimize=_this$events.afterMinimize,beforeMaximize=_this$events.beforeMaximize,afterMaximize=_this$events.afterMaximize;_this._closeBtn.addEventListener("click",function(e){return _this.close(e,beforeClose,afterClose)},false);_this._minBtn.addEventListener("click",function(e){return _this.minimize(e,beforeMinimize,afterMinimize)},false);_this._maxBtn.addEventListener("click",function(e){return _this.maximize(e,beforeMaximize,afterMaximize)},false)}};this.open=function(){if(!_this.isOpen()&&_this._window){var _this$events2=_this.events,beforeOpen=_this$events2.beforeOpen,afterOpen=_this$events2.afterOpen;typeof beforeOpen==="function"&&beforeOpen();document.body.appendChild(_this._window);_this._opened=true;_this._bindEvents();(0,_jquery.default)(_this._window).draggable(_this._draggableOptions).resizable(_this._resizableOptions);typeof afterOpen==="function"&&afterOpen()}};this.close=function(e,beforeClose,afterClose){if(_this.isOpen()&&_this._window){typeof beforeClose==="function"&&beforeClose(e);document.body.removeChild(_this._window);_this._opened=false;typeof afterClose==="function"&&afterClose(e)}};this.minimize=function(e,beforeMinimize,afterMinimize){typeof beforeMinimize==="function"&&beforeMinimize(e);_this._window=new _DomElement.default(_this._window).setStyle(_this._windowMinStyle).get();typeof afterMinimize==="function"&&afterMinimize(e)};this.maximize=function(e,beforeMaximize,afterMaximize){typeof beforeMaximize==="function"&&beforeMaximize(e);_this._window=new _DomElement.default(_this._window).setStyle(_this._windowMaxStyle).get();typeof afterMaximize==="function"&&afterMaximize(e)};var _props=props,windowStyle=_props.windowStyle,windowMaxStyle=_props.windowMaxStyle,windowMinStyle=_props.windowMinStyle,windowTitleStyle=_props.windowTitleStyle,windowBodyStyle=_props.windowBodyStyle,_props$title=_props.title,title=_props$title===void 0?"":_props$title,_props$bodyHTML=_props.bodyHTML,bodyHTML=_props$bodyHTML===void 0?"":_props$bodyHTML,_props$events=_props.events,events=_props$events===void 0?{}:_props$events,draggableOptions=_props.draggableOptions,resizableOptions=_props.resizableOptions;this._opened=false;this._windowStyle=(0,_utils.composeStyle)(_configs.windowDefaultStyle,windowStyle);this._windowMaxStyle=(0,_utils.composeStyle)(_configs.windowDefaultMaxStyle,windowMaxStyle);this._windowMinStyle=(0,_utils.composeStyle)(_configs.windowDefaultMinStyle,windowMinStyle);this._windowTitleStyle=(0,_utils.composeStyle)(_configs.windowTitleDefaultStyle,windowTitleStyle);this._windowBodyStyle=(0,_utils.composeStyle)(_configs.windowBodyDefaultStyle,windowBodyStyle);this._draggableOptions=(0,_utils.composeStyle)(_configs.defaultDraggableOptions,draggableOptions);this._resizableOptions=(0,_utils.composeStyle)(_configs.defaultResizableOptions,resizableOptions);this.title=title;this.bodyHtml=bodyHTML;this.events=events;this._closeBtn=this._btnGen("CLOSE");this._minBtn=this._btnGen("MIN");this._maxBtn=this._btnGen("MAX");this._btnGroup=this._btnGroupGen(this._closeBtn,this._minBtn,this._maxBtn);var _this$_windowGen=this._windowGen(),_window=_this$_windowGen[0],_windowTitle=_this$_windowGen[1],_windowBody=_this$_windowGen[2];this._window=_window;this._windowTitle=_windowTitle;this._windowBody=_windowBody};exports.default=PopupWindow;